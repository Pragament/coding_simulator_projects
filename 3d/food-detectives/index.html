<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸğŸ”¬ FOOD DETECTIVES â€¢ quiz & learn 3D</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: 'Segoe UI', system-ui, sans-serif; }
        #info-panel {
            position: absolute; top: 20px; left: 20px; background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px); padding: 15px 25px; border-radius: 50px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); border: 3px solid #ffb882;
            z-index: 10; display: flex; align-items: center; gap: 20px; flex-wrap: wrap;
        }
        #info-panel h1 { margin: 0; font-size: 2rem; color: #2d3e50; }
        #mode-toggle {
            display: flex; gap: 10px; background: #e0e7ff; padding: 5px; border-radius: 60px;
        }
        .mode-btn {
            border: none; padding: 8px 22px; border-radius: 40px; font-weight: bold;
            font-size: 1.3rem; cursor: pointer; transition: 0.2s; background: transparent;
        }
        .mode-btn.active { background: #2d3e50; color: white; box-shadow: 0 2px 10px #2d3e5080; }
        #quiz-panel {
            position: absolute; top: 120px; right: 30px; width: 340px;
            background: rgba(255,251,235,0.98); border-radius: 40px; padding: 25px;
            box-shadow: 0 20px 35px rgba(120, 60, 30, 0.3); border: 4px solid #ffb347;
            z-index: 30; backdrop-filter: blur(10px); font-size: 1.1rem;
            transition: 0.3s; max-height: 70vh; overflow-y: auto;
        }
        #quiz-header { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; }
        #quiz-header h2 { margin: 0; color: #7b3f00; font-size: 2rem; }
        #question-box {
            background: #fdeacb; border-radius: 35px; padding: 25px 18px;
            border: 3px dashed #c59b6c; margin-bottom: 20px;
        }
        #question-text { font-size: 1.6rem; font-weight: bold; color: #412d1b; margin: 10px 0; }
        #explanation-box {
            background: #f9f3e9; border-radius: 30px; padding: 20px;
            border-left: 12px solid #5f9ea0; display: none; margin-top: 20px;
        }
        #explanation-box.show { display: block; }
        .exp-head { font-size: 1.5rem; margin-bottom: 10px; display: flex; gap: 10px; }
        .exp-content { line-height: 1.6; color: #2c3e50; }
        .exp-content p { margin: 12px 0; }
        .quiz-controls { display: flex; gap: 10px; margin: 15px 0; flex-wrap: wrap; }
        .quiz-btn {
            background: #ffd89a; border: none; border-radius: 50px; padding: 12px 20px;
            font-weight: bold; font-size: 1.2rem; cursor: pointer; flex: 1 1 auto;
            transition: 0.1s; border-bottom: 4px solid #b87c3a;
        }
        .quiz-btn:active { transform: translateY(4px); border-bottom-width: 0; }
        #test-kit {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 15px; background: rgba(30, 30, 40, 0.8);
            backdrop-filter: blur(12px); padding: 18px 30px; border-radius: 80px;
            border: 3px solid #ffd966; z-index: 20;
        }
        .test-btn {
            background: #f8f9fa; border: none; border-radius: 50px; padding: 12px 22px;
            font-size: 1.4rem; font-weight: bold; display: flex; align-items: center; gap: 10px;
            cursor: pointer; transition: 0.2s; box-shadow: 0 5px 0 #6c757d;
            border-bottom: 3px solid #495057; pointer-events: auto;
        }
        .test-btn.starch { background: #cdb4db; color: #3c096c; }
        .test-btn.protein { background: #b7e4c7; color: #1e4a2b; }
        .test-btn.fat { background: #ffd7ba; color: #9e4a1f; }
        .test-btn.reset { background: #e9ecef; color: #2b3d4f; font-size: 1.2rem; }
        #learn-log {
            background: #fffcf0; border-radius: 30px; padding: 15px; margin-top: 20px;
            max-height: 200px; overflow-y: auto; border: 2px solid #ebb472;
        }
        .learn-item { padding: 6px 10px; border-radius: 30px; margin: 4px 0; background: #f7efe2; border-left: 8px solid #aaaaaa; }
        .safety-ribbon { position: absolute; bottom: 120px; left: 20px; background: #ffd966ee; padding: 6px 20px; border-radius: 40px; font-weight: bold; z-index: 25; border: 2px solid #b1610e; }
    </style>
</head>
<body>
    <!-- top bar with mode switch -->
    <div id="info-panel">
        <h1>ğŸ•µï¸â€â™€ï¸ FOOD DETECTIVES</h1>
        <div id="mode-toggle">
            <button class="mode-btn active" id="mode-learn">ğŸ“˜ LEARN</button>
            <button class="mode-btn" id="mode-quiz">â“ QUIZ</button>
        </div>
        <span style="font-size:2rem;">ğŸ¥”ğŸ¥›ğŸ§ˆ</span>
    </div>

    <!-- quiz panel (right) - visible only in quiz mode -->
    <div id="quiz-panel" style="display: none;">
        <div id="quiz-header">
            <h2>ğŸ§© quiz zone</h2>
            <span id="quiz-emoji">ğŸ¤”</span>
        </div>
        <div id="question-box">
            <div id="question-text">Click a food that contains <strong>protein</strong>!</div>
        </div>
        <div class="quiz-controls">
            <button class="quiz-btn" id="new-question">ğŸ”„ new question</button>
            <button class="quiz-btn" id="hint-btn">ğŸ’¡ hint</button>
        </div>
        <div id="explanation-box" class="">
            <div class="exp-head">ğŸ” explanation <span id="exp-emoji">ğŸ§ª</span></div>
            <div class="exp-content" id="exp-content">
                ğŸ‘† select a food to see explanation.
            </div>
        </div>
        <!-- learn mode mini log (shows tests) -->
        <div id="learn-log" style="display: none;">
            <div class="learn-item">âœ¨ click test then food</div>
        </div>
    </div>

    <!-- safety reminder -->
    <div class="safety-ribbon">âš ï¸ iodine stains â€¢ chemicals by teacher only â€¢ wash hands</div>

    <!-- test kit (always there, but used differently per mode) -->
    <div id="test-kit">
        <button class="test-btn starch" id="btn-starch">ğŸ§ª<span>STARCH</span></button>
        <button class="test-btn protein" id="btn-protein">ğŸ§´<span>PROTEIN</span></button>
        <button class="test-btn fat" id="btn-fat">ğŸ•¯ï¸<span>FAT</span></button>
        <button class="test-btn reset" id="btn-reset">âœ¨ RESET</button>
    </div>

    <!-- 3D canvas -->
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.128.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.128.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { CSS2DRenderer, CSS2DObject } from 'three/addons/renderers/CSS2DRenderer.js';

        // --- setup scene (same joyful lab) ---
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0xa8e6cf);
        scene.fog = new THREE.Fog(0xa8e6cf, 15, 30);
        const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(5, 4, 12);
        camera.lookAt(0, 1, 0);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.body.appendChild(renderer.domElement);
        const labelRenderer = new CSS2DRenderer();
        labelRenderer.setSize(window.innerWidth, window.innerHeight);
        labelRenderer.domElement.style.position = 'absolute';
        labelRenderer.domElement.style.top = '0px';
        labelRenderer.domElement.style.left = '0px';
        labelRenderer.domElement.style.pointerEvents = 'none';
        document.body.appendChild(labelRenderer.domElement);
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true; controls.maxPolarAngle = Math.PI / 2.2;
        controls.minDistance = 5; controls.maxDistance = 20; controls.target.set(0, 1.5, 0);

        // lights, floor, deco (simplified copy from original)
        const ambient = new THREE.AmbientLight(0xffffff, 0.6);
        scene.add(ambient);
        const mainLight = new THREE.DirectionalLight(0xfff5d1, 1.2);
        mainLight.position.set(5, 10, 7); mainLight.castShadow = true; mainLight.receiveShadow = true;
        mainLight.shadow.mapSize.width = 1024; mainLight.shadow.mapSize.height = 1024;
        const d = 10; mainLight.shadow.camera.left = -d; mainLight.shadow.camera.right = d;
        mainLight.shadow.camera.top = d; mainLight.shadow.camera.bottom = -d; mainLight.shadow.camera.near = 2; mainLight.shadow.camera.far = 20;
        scene.add(mainLight);
        const fillLight = new THREE.PointLight(0xffeedd, 0.5); fillLight.position.set(-3,4,5); scene.add(fillLight);
        const planeGeometry = new THREE.CircleGeometry(12, 32);
        const planeMaterial = new THREE.MeshStandardMaterial({ color: 0xd9b382 });
        const plane = new THREE.Mesh(planeGeometry, planeMaterial);
        plane.rotation.x = -Math.PI / 2; plane.position.y = 0; plane.receiveShadow = true;
        scene.add(plane);
        // a few decor
        const pillarMat = new THREE.MeshStandardMaterial({ color: 0xaaccff });
        const pillar = new THREE.Mesh(new THREE.CylinderGeometry(0.3, 0.3, 1.5), pillarMat);
        pillar.position.set(-3, 0.75, -3); pillar.castShadow = true; pillar.receiveShadow = true; scene.add(pillar);

        // ---------- FOOD DATASET (enriched) ----------
        const foods = [
            { name: 'ğŸ¥” potato', pos: [-2.0, 0.2, 0.5], starch: true, protein: false, fat: false, color: 0xc99a6b, emoji: 'ğŸ¥”', fact: 'Potatoes store energy as starch â€” like a battery for the plant!', rhyme: 'Potato brown, starch in town.' },
            { name: 'ğŸš rice', pos: [0.5, 0.1, -0.8], starch: true, protein: false, fat: false, color: 0xf5f0d7, emoji: 'ğŸš', fact: 'Rice grains are full of starch, which gives you running power.', rhyme: 'Rice is nice, starch gives spice.' },
            { name: 'ğŸ bread', pos: [2.2, 0.3, 1.2], starch: true, protein: false, fat: false, color: 0xe0b059, emoji: 'ğŸ', fact: 'Bread bubbles from yeast, but the starch is what turns iodine blue!', rhyme: 'Bread in the toaster, starch is the booster.' },
            { name: 'ğŸ¥š egg white', pos: [-1.2, 0.5, 2.5], starch: false, protein: true, fat: true, color: 0xf3f0e0, emoji: 'ğŸ¥š', fact: 'Egg whites are almost pure protein â€” they help chicks grow muscles!', rhyme: 'Egg white and yolk, protein for folk.' },
            { name: 'ğŸ«˜ dal', pos: [1.8, 0.2, -1.8], starch: false, protein: true, fat: false, color: 0xb37b5e, emoji: 'ğŸ«˜', fact: 'Lentils (dal) are plant-based protein â€” body building blocks!', rhyme: 'Dal is protein, strong and lean.' },
            { name: 'ğŸ§ˆ butter', pos: [-2.5, 0.3, -1.8], starch: false, protein: false, fat: true, color: 0xffe57a, emoji: 'ğŸ§ˆ', fact: 'Butter is mostly fat â€” it leaves a permanent grease spot on paper.', rhyme: 'Butter melt, fat is felt.' },
            { name: 'ğŸ¥œ peanut', pos: [3.0, 0.2, 0.0], starch: false, protein: true, fat: true, color: 0xc49a6c, emoji: 'ğŸ¥œ', fact: 'Peanuts have protein for muscles AND fat for energy!', rhyme: 'Peanut double-pack: protein and fat snack.' },
            { name: 'ğŸ apple', pos: [0.0, 0.3, 2.8], starch: false, protein: false, fat: false, color: 0xeF4f4f, emoji: 'ğŸ', fact: 'Apples have natural sugar and fibre â€” but no starch, protein or fat.', rhyme: 'Apple fresh, no starchy mess.' }
        ];

        const foodMeshes = [];
        foods.forEach((f) => {
            const geometry = new THREE.SphereGeometry(0.45, 32, 32);
            const material = new THREE.MeshStandardMaterial({ color: f.color, emissive: 0x221100, emissiveIntensity: 0.1 });
            const sphere = new THREE.Mesh(geometry, material);
            sphere.position.set(f.pos[0], f.pos[1], f.pos[2]);
            sphere.castShadow = true; sphere.receiveShadow = true;
            sphere.userData = { type: 'food', food: f };
            scene.add(sphere);
            if (f.name.includes('apple')) {
                const stemGeo = new THREE.CylinderGeometry(0.05, 0.05, 0.2);
                const stemMat = new THREE.MeshStandardMaterial({ color: 0x5a3e1a });
                const stem = new THREE.Mesh(stemGeo, stemMat);
                stem.position.set(0, 0.5, 0.1); sphere.add(stem);
            }
            foodMeshes.push(sphere);
            // label (emoji)
            const div = document.createElement('div');
            div.textContent = f.emoji;
            div.style.fontSize = '32px'; div.style.fontWeight = 'bold'; div.style.textShadow = '2px 2px 4px #00000080';
            div.style.background = 'rgba(255,255,240,0.7)'; div.style.padding = '4px 12px'; div.style.borderRadius = '40px';
            div.style.border = '2px solid white'; div.style.backdropFilter = 'blur(4px)'; div.style.pointerEvents = 'none';
            const label = new CSS2DObject(div);
            label.position.set(f.pos[0], f.pos[1] + 0.9, f.pos[2]);
            scene.add(label);
        });

        // --- UI Elements ---
        const quizPanel = document.getElementById('quiz-panel');
        const learnLogDiv = document.getElementById('learn-log');
        const explanationBox = document.getElementById('explanation-box');
        const expContent = document.getElementById('exp-content');
        const questionText = document.getElementById('question-text');
        const modeLearnBtn = document.getElementById('mode-learn');
        const modeQuizBtn = document.getElementById('mode-quiz');
        const newQuestionBtn = document.getElementById('new-question');
        const hintBtn = document.getElementById('hint-btn');
        const quizEmoji = document.getElementById('quiz-emoji');
        const expEmoji = document.getElementById('exp-emoji');

        // State
        let currentMode = 'learn'; // 'learn' or 'quiz'
        let activeTest = null;      // for learn mode
        let currentQuizAnswer = null; // nutrient to look for: 'starch', 'protein', 'fat', or 'none'
        let quizQuestionNutrient = 'protein'; // default

        // --- helper functions for quiz
        function generateQuestion() {
            const nutrients = ['starch', 'protein', 'fat', 'none'];
            const randomIndex = Math.floor(Math.random() * nutrients.length);
            const nutrient = nutrients[randomIndex];
            quizQuestionNutrient = nutrient;
            
            let question = '';
            if (nutrient === 'starch') question = 'ğŸ”µ Click a food that contains STARCH (turns iodine blue-black)!';
            else if (nutrient === 'protein') question = 'ğŸŸ£ Click a food that contains PROTEIN (turns violet in biuret test)!';
            else if (nutrient === 'fat') question = 'ğŸŸ  Click a food that contains FAT (leaves a greasy spot on paper)!';
            else if (nutrient === 'none') question = 'âšª Click a food that has NO starch, NO protein, and NO fat (like a fruit)!';
            
            questionText.innerHTML = question;
            explanationBox.classList.remove('show');
            expContent.innerHTML = 'ğŸ‘† click a food to check your answer.';
            quizEmoji.textContent = nutrient === 'starch' ? 'ğŸ”ğŸ¥”' : (nutrient === 'protein' ? 'ğŸ¥šğŸ”¬' : (nutrient === 'fat' ? 'ğŸ§ˆğŸ§»' : 'ğŸğŸ¤”'));
        }

        function showExplanation(food, selectedNutrient) {
            const nutrient = selectedNutrient; // what the question asked
            const hasStarch = food.starch;
            const hasProtein = food.protein;
            const hasFat = food.fat;
            
            let isCorrect = false;
            if (nutrient === 'starch' && hasStarch) isCorrect = true;
            else if (nutrient === 'protein' && hasProtein) isCorrect = true;
            else if (nutrient === 'fat' && hasFat) isCorrect = true;
            else if (nutrient === 'none' && !hasStarch && !hasProtein && !hasFat) isCorrect = true;
            
            // build rich explanation
            let html = `<p><strong>${food.name}</strong> â€” ${food.fact} ${food.rhyme ? ' ğŸµ ' + food.rhyme : ''}</p>`;
            html += '<ul style="list-style-type: none; padding-left: 5px;">';
            html += `<li>ğŸ§ª Starch: ${hasStarch ? 'âœ… YES (blue-black)' : 'âŒ no'}</li>`;
            html += `<li>ğŸ§´ Protein: ${hasProtein ? 'âœ… YES (violet)' : 'âŒ no'}</li>`;
            html += `<li>ğŸ•¯ï¸ Fat: ${hasFat ? 'âœ… YES (greasy spot)' : 'âŒ no'}</li>`;
            html += '</ul>';
            
            if (isCorrect) {
                html += '<p style="background:#c8e6c9; border-radius:40px; padding:12px; border:3px solid green;">âœ… <strong>Correct!</strong> Great detecting! ' + 
                    (nutrient==='starch'? 'Iodine turns blueâ€‘black in starch.' : 
                     nutrient==='protein'? 'Biuret test turns violet for protein.' : 
                     nutrient==='fat'? 'Fat leaves a seeâ€‘through grease spot.' : 
                     'This food is free of starch, protein, and fat.') + '</p>';
                expEmoji.textContent = 'ğŸ†âœ¨';
            } else {
                html += '<p style="background:#ffcdd2; border-radius:40px; padding:12px; border:3px solid red;">âŒ <strong>Not quite.</strong> ' + 
                    (nutrient==='starch'? 'Look for foods like potato, rice, bread.' : 
                     nutrient==='protein'? 'Egg, dal, and peanuts have protein.' : 
                     nutrient==='fat'? 'Butter, peanuts, and egg yolk have fat.' : 
                     'Apple has no starch/protein/fat.') + '</p>';
                expEmoji.textContent = 'ğŸ”ğŸ¤”';
            }
            
            // add real-world connection
            html += '<hr><p><em>ğŸŒŸ Real-world: ' + 
                (food.starch ? 'Starch gives you energy to run.' : food.protein ? 'Protein builds muscles.' : food.fat ? 'Fat stores energy and keeps you warm.' : 'Fruits give vitamins without starch/fat.') + 
                ' Think about it: why do athletes eat eggs? (protein for muscles!)</em></p>';
            
            expContent.innerHTML = html;
            explanationBox.classList.add('show');
        }

        // --- mode switching ---
        modeLearnBtn.addEventListener('click', () => {
            currentMode = 'learn';
            modeLearnBtn.classList.add('active');
            modeQuizBtn.classList.remove('active');
            quizPanel.style.display = 'none';
            learnLogDiv.style.display = 'block'; // inside quiz panel but we hide panel? Actually we need show learn-log elsewhere. Let's adapt: we show quiz panel but with learn log visible, hide quiz elements.
            // simpler: in learn mode we hide quiz panel entirely. We'll show the floating log in another area? for simplicity, we will hide quiz panel and rely on bottom test kit + the small log? but we need a log area. We'll repurpose quiz panel as learn panel.
            quizPanel.style.display = 'block';
            document.getElementById('quiz-header').innerHTML = '<h2>ğŸ“˜ learn lab</h2><span>ğŸ§ª</span>';
            questionBox.style.display = 'none';
            document.querySelector('.quiz-controls').style.display = 'none';
            explanationBox.style.display = 'none';
            learnLogDiv.style.display = 'block';
            // reset any active test highlight?
        });

        modeQuizBtn.addEventListener('click', () => {
            currentMode = 'quiz';
            modeQuizBtn.classList.add('active');
            modeLearnBtn.classList.remove('active');
            quizPanel.style.display = 'block';
            document.getElementById('quiz-header').innerHTML = '<h2>ğŸ§© quiz zone</h2><span id="quiz-emoji">ğŸ¤”</span>';
            document.getElementById('question-box').style.display = 'block';
            document.querySelector('.quiz-controls').style.display = 'flex';
            explanationBox.style.display = 'none';
            learnLogDiv.style.display = 'none';
            generateQuestion();
        });

        // default start in learn mode (but quiz panel shows learn log)
        modeLearnBtn.click();

        // --- learn mode test buttons (similar to original but logging into learnLogDiv) ---
        const btnStarch = document.getElementById('btn-starch');
        const btnProtein = document.getElementById('btn-protein');
        const btnFat = document.getElementById('btn-fat');
        const btnReset = document.getElementById('btn-reset');

        function addLearnLog(message, type) {
            const entry = document.createElement('div');
            entry.className = 'learn-item';
            if (type === 'starch') entry.style.borderLeftColor = '#1e3a5f';
            if (type === 'protein') entry.style.borderLeftColor = '#7b2e8a';
            if (type === 'fat') entry.style.borderLeftColor = '#b85e00';
            entry.textContent = message;
            learnLogDiv.prepend(entry);
            if (learnLogDiv.children.length > 8) learnLogDiv.removeChild(learnLogDiv.lastElementChild);
        }

        btnStarch.addEventListener('click', () => { if (currentMode === 'learn') activeTest = 'starch'; addLearnLog('ğŸ§ª starch test active', 'starch'); });
        btnProtein.addEventListener('click', () => { if (currentMode === 'learn') activeTest = 'protein'; addLearnLog('ğŸ§´ protein test active', 'protein'); });
        btnFat.addEventListener('click', () => { if (currentMode === 'learn') activeTest = 'fat'; addLearnLog('ğŸ•¯ï¸ fat test active', 'fat'); });
        btnReset.addEventListener('click', () => { activeTest = null; learnLogDiv.innerHTML = '<div class="learn-item">âœ¨ reset â€” choose a test</div>'; });

        // --- clicking on food (main interaction) ---
        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();

        renderer.domElement.addEventListener('click', (event) => {
            const rect = renderer.domElement.getBoundingClientRect();
            mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
            mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(foodMeshes);
            if (intersects.length === 0) return;
            
            const hit = intersects[0].object;
            const food = hit.userData.food;
            
            // visual feedback
            hit.material.emissive.setHex(0x884400);
            hit.material.emissiveIntensity = 0.6;
            setTimeout(() => { hit.material.emissiveIntensity = 0.1; hit.material.emissive.setHex(0x221100); }, 300);

            if (currentMode === 'learn') {
                if (!activeTest) {
                    addLearnLog('âš ï¸ select a test first (starch/protein/fat)', 'info');
                    return;
                }
                let result = '';
                if (activeTest === 'starch') {
                    result = food.starch ? `âœ… ${food.name} â†’ blueâ€‘black (starch)` : `â– ${food.name} â†’ no starch`;
                    addLearnLog(result, food.starch ? 'starch' : 'info');
                } else if (activeTest === 'protein') {
                    result = food.protein ? `âœ… ${food.name} â†’ violet (protein)` : `â– ${food.name} â†’ no protein`;
                    addLearnLog(result, food.protein ? 'protein' : 'info');
                } else if (activeTest === 'fat') {
                    result = food.fat ? `âœ… ${food.name} â†’ greasy spot (fat)` : `â– ${food.name} â†’ no fat`;
                    addLearnLog(result, food.fat ? 'fat' : 'info');
                }
            } else if (currentMode === 'quiz') {
                // quiz mode: check against currentQuizAnswer (nutrient)
                showExplanation(food, quizQuestionNutrient);
            }
        });

        // quiz buttons
        newQuestionBtn.addEventListener('click', generateQuestion);
        hintBtn.addEventListener('click', () => {
            let hint = '';
            if (quizQuestionNutrient === 'starch') hint = 'ğŸ¥” potato, ğŸš rice, ğŸ bread often have starch.';
            else if (quizQuestionNutrient === 'protein') hint = 'ğŸ¥š egg white, ğŸ«˜ dal, ğŸ¥œ peanut have protein.';
            else if (quizQuestionNutrient === 'fat') hint = 'ğŸ§ˆ butter, ğŸ¥œ peanut, ğŸ¥š egg yolk have fat.';
            else hint = 'ğŸ apple has no starch, protein, or fat.';
            expContent.innerHTML = `<strong>ğŸ’¡ hint:</strong> ${hint}`;
            explanationBox.classList.add('show');
        });

        // animation
        function animate() {
            requestAnimationFrame(animate);
            const time = Date.now() * 0.002;
            foodMeshes.forEach((mesh, i) => { mesh.position.y = foods[i].pos[1] + Math.sin(time + i) * 0.04; });
            controls.update();
            renderer.render(scene, camera);
            labelRenderer.render(scene, camera);
        }
        animate();

        // resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            labelRenderer.setSize(window.innerWidth, window.innerHeight);
        });

        // initial quiz question
        generateQuestion();
    </script>
</body>
</html>
